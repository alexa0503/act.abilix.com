function wxShare(a){wx.ready(function(){wx.onMenuShareAppMessage({title:a.title,desc:a.desc,link:a.link,imgUrl:a.imgUrl,type:a.type||"link",dataUrl:a.dataUrl||"",success:function(){_czc.push(["_trackEvent","abilix-H5","bt-分享完成"])},cancel:function(){}}),wx.onMenuShareTimeline({title:a.title,desc:a.desc,link:a.link,imgUrl:a.imgUrl,type:a.type||"link",dataUrl:a.dataUrl||"link",success:function(){_czc.push(["_trackEvent","abilix-H5","bt-分享完成"])},cancel:function(){}})})}function getWork(a){$(document).bind(".abilix");var e="/work/"+a;$.ajax({url:e,dataType:"json",method:"GET"}).done(function(e){var i=$("#page-work .heart a");$("#work-id").html(e.id),$("#work-image").attr("src",e.image),$("#work-name").html(e.name),$("#work-vote").html(e.vote_num),$("#work-ranking").html(e.ranking_num),e.has_voted?i.find("img").eq(1).removeClass("hide"):i.find("img").eq(0).removeClass("hide"),$(".page").addClass("hide"),$("#page-work").removeClass("hide"),$("#page-work .heart a").bind("click",function(a){vote(e.id,i)}),wxData.imgUrl=e.image,wxData.link="http://"+window.location.host+"/list/"+a,wxShare(wxData)}).fail(function(){alert("获取信息失败，请稍候重试~")}).always(function(){})}function vote(a,e){$(document).unbind(".abilix");var i="/vote/"+a;hasVoted||(hasVoted=!0,$.ajax({url:i,dataType:"json",method:"GET"}).done(function(a){var i,t=e.find("img"),n=e.parent(".heart");t.eq(1).hasClass("hide")?(i=n.append('<div class="animation1">+1</div>').find(".animation1"),i.animate({top:"-20px"},800,"linear",function(){i.hide(20).remove(),t.eq(0).addClass("hide"),t.eq(1).removeClass("hide"),n.find("span").text(a.vote_num),hasVoted=!1})):(i=n.append('<div class="animation2">-1</div>').find(".animation2"),i.animate({top:"80px"},800,"linear",function(){i.hide(20).remove(),t.eq(1).addClass("hide"),t.eq(0).removeClass("hide"),n.find("span").text(a.vote_num),hasVoted=!1}))}).fail(function(){alert("点赞失败，请稍候重试~"),hasVoted=!1}).always(function(){}))}var hasVoted=!1;$().ready(function(){$(document).bind("ajaxStart.abilix",function(){hasSubmitted=!0,$("#modal-tip").modal({keyboard:!1,show:!0,backdrop:"static"})}),$(document).bind("ajaxComplete.abilix",function(){hasSubmitted=!1,$("#modal-tip").modal("hide")})});